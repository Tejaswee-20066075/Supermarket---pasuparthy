<!DOCTYPE html>
<html>
<head>
  <title>Login Page</title>
  <link rel="stylesheet" href="loginpage.css">
</head>
  <body>
    <div class="login-box">
      <h2>Login to your aAccount!</h2>
      <form id="loginForm" name="loginForm" onsubmit="return validateLogin()">
        <input type="email" id="email" name="email" placeholder="Email" required>
        <input type="password" id="password" name="password" placeholder="Password" required>
        <button type="submit">Login</button>
      </form>
    <p><a href="register.html">Don't have an account? Register Now</a></p>
    <script>
      var API_URL = "https://glowing-meme-jj7wq64jpl4qjc4jg-5000.app.github.dev";                     //connect with backend flask with port 5000
      function validateLogin() {                                                                                  //creating function to validate login credentials
        var email = document.loginForm.email.value                                                                // variable email get from login form
        var pass  = document.loginForm.password.value                                                             // variable pass get from login form
        fetch(API_URL + "/api/login", {                                                                           //calling backend login API
        method: "POST",                                                                                           //POST the login data in json format also converts js object to json
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email: email, password: pass })
        })
        .then(function(response) {                                                                       //response in here contains status code like 200,400,404
          return response.json().then(function(data) {                                                   //that response convert to js object
              if (response.ok) {                                                                         //reponse ok means it is success
                  alert("You have Logged in Successfully!");                                             //throws success message with redirecting page to products.html
                  window.location = "products.html";
              } else {
                  alert(data.error || "Invalid username or password");                                   //if data is error then throw message invalid
              }
          });
        })
        .catch(function(error) {                                                                 //catch runs when serve or network issue occurs
        alert("Error connecting to server");                                                     //shows issue with backend connectivity
        console.error(error);
    });

    return false;                              //stop page to refresh
}
    </script>  
  </body>
  </html>
